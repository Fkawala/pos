==============================
Point of Sale - Self weighing 
==============================

.. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fpos-lightgray.png?logo=github
    :target: https://github.com/OCA/pos/tree/9.0/pos_self_weighing
    :alt: OCA/pos
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/pos-9-0/pos-9-0-pos_self_weighing
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
    :target: https://runbot.odoo-community.org/runbot/184/9.0
    :alt: Try me on Runbot

|badge1| |badge2| |badge3| |badge4| |badge5| 

This add-on allows you to run a grocery in a Bring Your Own Container (BYOC) schema. With this add-on your customers will be able to buy loose goods using their own reusable container. This add-on also enables customers to weight their vegetables and fruits before they checkout. To weight fruit and vegetable before checkout will speed up the checkout and make your customer happier.

The *self service* BYOC scheme has six steps:
    1. The customer weighs her-his pot and sticks the tare barcode onto the pot.
    2. The customer puts loose goods into the labeled pot.
    3. The customer scans the tare barcode. POS saves the tare value.
    4. The customer weighs the pot with loose goods inside. POS computes the price to pay from gross weight and tare weight.
    5. The customer gets a price barcode label indicating the price to pay.
    6. During checkout, the cashier swiftly scans the price barcode label.


This add-on requires you to have a barcode label printer and an electronic scale. Your customers are expected to use this add-on in a self-service way. This add-on adds multiple news screens that are displayed only on the selected POS.

This add-on displays only the products that are meant to be weighted with a scale.

Home screen of the selected POS is:

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/default_screen.png

To click on "tare a container" shows:

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/tare_screen.png

To click on "weight a product in a container" shows:

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/tare_scan_screen.png

To click on "weight a product" shows:

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/product_screen.png

**Table of contents**

.. contents::
   :local:

Configuration
=============

Introduction
~~~~~~~~~~~~
Install this add-on and configure the point of sale where you want to use a self service weighing station. The label printing is done using web print.
This add-on requires to be connected to Odoo POS from a computer that'll be accessible by your customers/members. In order to limit the risk of unfortunate/malicious actions on this POS you should:

* **Use a dedicated odoo account with the least possible rights**
* Configure the web browser to be in kiosk mode (only browsing without navigation bar)

Those measures aren't sufficient *per se*, but should lower the risk significantly.

Setup the self service POS
~~~~~~~~~~~~~~~~~~~~~~~~~~
1. Create a new POS
2. Setup hardware proxy
    * Make sure you have a valid SSL certificate issued for POSBOX host (see below).
    * Enable electronic scale
    * Enable barcode reader
3. Enable self service weighing
    * Use the checkbox as shown on screen shot below.
    * If your label printer is able to distribute several labels in a row you can select the `Enable weighing station to print multiple labels at once`. With this option your customers will be able to weigh several products and print all the labels at once. This is assumed to be more efficient.

See the screenshot below, you new POS should page should like this.

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/configuration_details.png

Setup a barcode for each product "to weight with a scale"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the default odoo barcode nomenclature, a barcode with prefix 21 is a "weight" barcode.
The default way to process a weight barcode in odoo is to match the base part of the barcode (*ie*. the two digits prefix and the following five digits).
For instance, if you setup barcode **21 12345 00000 8** for your carrots, any barcode with pattern **21 12345 \*\*\*\*\* \*** will be a match for carrots.
This add-on uses weight barcode to encode labels. Therefore, with the previous barcode, **21 12345 01000 7** is be the label for 1kg of carrots. Be sure to have a barcode setup for each article you want to weight with a scale. See screenshot below.

.. image:: https://raw.githubusercontent.com/OCA/pos/9.0/pos_self_weighing/static/description/barcode_config.png


SSL certificate generation
~~~~~~~~~~~~~~~~~~~~~~~~~~
Nowadays for any internet facing service the most convenient, secure, and fast way to get SSL certificates is [letsencrypt](https://letsencrypt.org/).
However, it is likely (and expected) that your POSBox and the computer used to display to self weighing POS belong to same network.
In such a situation to use a self issued SSL certificate is a valid option.
To use a self issued SSL certificate is low maintenance as you can set an arbitrarily far expiration date.
As your HTTPS communications are expected to happen locally the security risk of using a self issued SSL certificate is fairly low.

See bash scripts in the GIST below to:
    * create a certification authority
    * self issue a SSL certificate with this certification authority
    * setup a nginx reverse proxy serving the posbox with the self issued SSL certificate
    * Install the certification authority into the web browser of the computer displaying the self weighing POS belong so that the self issued SSL certificate is considered valid by chrome and firefox.

https://gist.github.com/Fkawala/0d46376d3abb7369d34afefaa1ac98fa

Firefox
~~~~~~~
See below how to setup firefox in silent printing mode is described below [source](http://manual.koha-community.org/3.2/en/firefoxreceipt.html)

1. Open File > Page Setup

   * Make all the headers and footers blank
   * Set the margins to 0 (zero)

2. In the address bar of Firefox, type about:config

   * Search for print.always_print_silent and double click it
   * Change it from false to true
   * If print.always_print_silent does not come up:
       * Right click on a blank area of the preference window
       * Select new > Boolean
       * Enter "print.always_print_silent" as the name (without quotes)
       * Click OK
       * Select true for the value

You may also want to check what is listed for print.print_printer. You may have to choose Generic/Text Only (or whatever your receipt printer might be named)

Chrome
~~~~~~
Chrome base browsers have a kiosk mode. In kiosk mode the navigation bar is disabled and user action are limited to web browsing. To start a chrome base browser in kiosk mode with silent printing use the command below.

``chromium-browser --use-system-default-printer --kiosk --kiosk-printing http://localhost:8069/``

Usage
=====

1. Setup the add-on as explained in the **configuration** section
2. Start the POS
3. Let your happy customers/members use the POS to print price labels for fruits, vegetables and loose goods, let them enjoy a swift checkout process

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/pos/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us smashing it by providing a detailed and welcomed
`feedback <https://github.com/OCA/pos/issues/new?body=module:%20pos_self_weighing%0Aversion:%209.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Le Nid

Contributors
~~~~~~~~~~~~

- Le Nid
- SPP Meyrin
- CoopItEasy
- Icons made by Freepik from flaticon.com

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

.. |maintainer-fkawala| image:: https://github.com/fkawala.png?size=40px
    :target: https://github.com/fkawala
    :alt: fkawala

Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:

|maintainer-fkawala| 

This module is part of the `OCA/pos <https://github.com/OCA/pos/tree/9.0/pos_self_weighing>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
